# from datetime import date
# from fincore.storage.connection import get_connection
# from fincore.logging.logger import get_logger

# log = get_logger("universe")

NIFTY_500 = [
    "TARIL.NS","ANANTRAJ.NS","HINDZINC.NS","HINDCOPPER.NS","CCL.NS","GMRAIRPORT.NS","CHOICEIN.NS",
    "JSWENERGY.NS","NIACL.NS","KAYNES.NS","NATIONALUM.NS","GMDCLTD.NS","SARDAEN.NS","CUB.NS","IKS.NS",
    "RELINFRA.NS","PNBHOUSING.NS","IDBI.NS","NAM-INDIA.NS","DALBHARAT.NS","GRAVITA.NS","BPCL.NS",
    "SWIGGY.NS","IDEA.NS","MOTILALOFS.NS","SAMMAANCAP.NS","NMDC.NS","AIAENG.NS","KIRLOSBROS.NS",
    "TATASTEEL.NS","JSWINFRA.NS","HINDALCO.NS","NLCINDIA.NS","BLUESTARCO.NS","RPOWER.NS","ABFRL.NS",
    "RAMCOCEM.NS","BANDHANBNK.NS","SOBHA.NS","COROMANDEL.NS","DIXON.NS","BHEL.NS","MUTHOOTFIN.NS",
    "PGEL.NS","NUVOCO.NS","THERMAX.NS","CRISIL.NS","TEJASNET.NS","ADANIPOWER.NS","HINDPETRO.NS",
    "INOXWIND.NS","MMTC.NS","VEDL.NS","SRF.NS","WAAREEENER.NS","USHAMART.NS","3MINDIA.NS","PAYTM.NS",
    "FORCEMOT.NS","NAUKRI.NS","ETERNAL.NS","MANYAVAR.NS","GSPL.NS","NSLNISP.NS","ABCAPITAL.NS",
    "AEGISLOG.NS","MCX.NS","GPIL.NS","HEXT.NS","ULTRACEMCO.NS","ENDURANCE.NS","ASHOKLEY.NS",
    "JMFINANCIL.NS","FORTIS.NS","KIRLOSENG.NS","VMM.NS","JKCEMENT.NS","IDFCFIRSTB.NS","IIFL.NS",
    "GICRE.NS","SUZLON.NS","EMCURE.NS","HONASA.NS","UTIAMC.NS","FACT.NS","ICICIPRULI.NS",
    "PERSISTENT.NS","AUROPHARMA.NS","SONACOMS.NS","GODREJPROP.NS","LTF.NS","OBEROIRLTY.NS",
    "JUBLINGREA.NS","ADANIGREEN.NS","SAIL.NS","AMBUJACEM.NS","KAJARIACER.NS","GODFRYPHLP.NS",
    "PGHH.NS","LT.NS","KARURVYSYA.NS","GVT&D.NS","KALYANKJIL.NS","M&MFIN.NS","VOLTAS.NS","HSCL.NS",
    "OLECTRA.NS","TRIVENI.NS","MARUTI.NS","JSWSTEEL.NS","GRANULES.NS","POWERINDIA.NS","BRIGADE.NS",
    "DOMS.NS","NESTLEIND.NS","JINDALSTEL.NS","AMBER.NS","ABSLAMC.NS","ANANDRATHI.NS","KEC.NS",
    "EMAMILTD.NS","LUPIN.NS","ATUL.NS","UNIONBANK.NS","BHARATFORG.NS","GESHIP.NS","CROMPTON.NS",
    "BHARTIARTL.NS","BLUEJET.NS","THELEELA.NS","IGL.NS","NUVAMA.NS","ITCHOTELS.NS","CHAMBLFERT.NS",
    "DBREALTY.NS","CHALET.NS","SUNDARMFIN.NS","MAPMYINDIA.NS","AFFLE.NS","SCI.NS","SCHNEIDER.NS",
    "CANFINHOME.NS","IOC.NS","ECLERX.NS","ACE.NS","CUMMINSIND.NS","PPLPHARMA.NS","HBLENGINE.NS",
    "TRITURBINE.NS","MOTHERSON.NS","AKZOINDIA.NS","TATAINVEST.NS","INDUSINDBK.NS","NETWEB.NS",
    "PHOENIXLTD.NS","UNOMINDA.NS","ELECON.NS","GUJGASLTD.NS","SYNGENE.NS","NAVINFLUOR.NS","IFCI.NS",
    "JWL.NS","GRASIM.NS","SBILIFE.NS","ADANIPORTS.NS","BALKRISIND.NS","BIKAJI.NS","RHIM.NS",
    "LICI.NS","BSE.NS","MANAPPURAM.NS","ABREL.NS","IREDA.NS","GAIL.NS","POLYCAB.NS","CYIENT.NS",
    "JINDALSAW.NS","COHANCE.NS","BRITANNIA.NS","MSUMI.NS","APOLLOHOSP.NS","CRAFTSMAN.NS","AXISBANK.NS",
    "MEDANTA.NS","INDUSTOWER.NS","TITAGARH.NS","TATACOMM.NS","BIOCON.NS","JKTYRE.NS","BAJFINANCE.NS",
    "INDIANB.NS","NBCC.NS","ACMESOLAR.NS","MAHSEAMLES.NS","BAJAJFINSV.NS","SHREECEM.NS","INDIGO.NS",
    "TCS.NS","INDHOTEL.NS","LATENTVIEW.NS","ATGL.NS","ADANIENSOL.NS","CHOLAFIN.NS","FIRSTCRY.NS",
    "ELGIEQUIP.NS","RRKABEL.NS","NEWGEN.NS","SHYAMMETL.NS","LINDEINDIA.NS","AWL.NS","PREMIERENE.NS",
    "RADICO.NS","CLEAN.NS","SAPPHIRE.NS","TECHM.NS","MFSL.NS","SYRMA.NS","JIOFIN.NS","APLAPOLLO.NS",
    "SIGNATURE.NS","NTPC.NS","ABB.NS","TATACHEM.NS","ITI.NS","LODHA.NS","NYKAA.NS","NTPCGREEN.NS",
    "JBMA.NS","LLOYDSME.NS","COFORGE.NS","TITAN.NS","DLF.NS","TATACONSUM.NS","ASTRAL.NS","TIMKEN.NS",
    "GLENMARK.NS","VBL.NS","RVNL.NS","AAVAS.NS","360ONE.NS","ASTERDM.NS","SUNTV.NS","RELIANCE.NS",
    "KEI.NS","NHPC.NS","ZEEL.NS","CESC.NS","BEML.NS","TBOTEK.NS","POONAWALLA.NS","IRCTC.NS",
    "TORNTPOWER.NS","ANGELONE.NS","TVSMOTOR.NS","HAVELLS.NS","ZYDUSLIFE.NS","TATATECH.NS",
    "AEGISVOPAK.NS","PCBL.NS","PFIZER.NS","PIDILITIND.NS","HUDCO.NS","DRREDDY.NS","JSL.NS",
    "LEMONTREE.NS","RAINBOW.NS","VGUARD.NS","GODREJIND.NS","TRENT.NS","WIPRO.NS","HDFCLIFE.NS",
    "APARINDS.NS","AADHARHFC.NS","MINDACORP.NS","PRESTIGE.NS","UNITDSPR.NS","TECHNOE.NS","RITES.NS",
    "SKFINDIA.NS","ICICIBANK.NS","BEL.NS","KIMS.NS","EIDPARRY.NS","TATAPOWER.NS","PATANJALI.NS",
    "CHENNPETRO.NS","KPRMILL.NS","SBFC.NS","ZENSARTECH.NS","EIHOTEL.NS","PFC.NS","M&M.NS","DMART.NS",
    "WOCKPHARMA.NS","BAYERCROP.NS","BSOFT.NS","REDINGTON.NS","AJANTPHARM.NS","CONCORDBIO.NS",
    "DELHIVERY.NS","ZENTEC.NS","CENTURYPLY.NS","BANKINDIA.NS","TATAELXSI.NS","CHOLAHLDNG.NS",
    "CAPLIPOINT.NS","VENTIVE.NS","ALOKINDS.NS","IRFC.NS","ADANIENT.NS","GODREJCP.NS","BERGEPAINT.NS",
    "HDFCBANK.NS","SUMICHEM.NS","CIPLA.NS","IEX.NS","HEG.NS","CGCL.NS","KPITTECH.NS","DEEPAKFERT.NS",
    "SHRIRAMFIN.NS","POLYMED.NS","HONAUT.NS","LTTS.NS","GODIGIT.NS","GRAPHITE.NS","CREDITACC.NS",
    "FINCABLES.NS","MANKIND.NS","LTIM.NS","SAGILITY.NS","HAPPSTMNDS.NS","HDFCAMC.NS","MARICO.NS",
    "TMPV.NS","WHIRLPOOL.NS","SBICARD.NS","PTCIL.NS","CARBORUNIV.NS","ASAHIINDIA.NS","UPL.NS",
    "PNB.NS","SJVN.NS","CDSL.NS","COCHINSHIP.NS","J&KBANK.NS","ASTRAZEN.NS","CASTROLIND.NS",
    "BLUEDART.NS","BATAINDIA.NS","FIVESTAR.NS","UBL.NS","FEDERALBNK.NS","RECLTD.NS","NIVABUPA.NS",
    "MPHASIS.NS","HYUNDAI.NS","COLPAL.NS","INFY.NS","FSL.NS","IOB.NS","ARE&M.NS","MGL.NS",
    "TRIDENT.NS","YESBANK.NS","CONCOR.NS","FINPIPE.NS","MAHSCOOTER.NS","SBIN.NS","BAJAJHFL.NS",
    "LTFOODS.NS","BLS.NS","KOTAKBANK.NS","ONGC.NS","HCLTECH.NS","STARHEALTH.NS","OLAELEC.NS",
    "JYOTHYLAB.NS","CGPOWER.NS","DIVISLAB.NS","OFSS.NS","WELCORP.NS","WELSPUNLIV.NS","ALKEM.NS",
    "DATAPATTNS.NS","VTL.NS","CANBK.NS","TIINDIA.NS","ICICIGI.NS","DEEPAKNTR.NS","BASF.NS",
    "LICHSGFIN.NS","COALINDIA.NS","RCF.NS","PAGEIND.NS","JPPOWER.NS","GODREJAGRO.NS","LALPATHLAB.NS",
    "NCC.NS","BDL.NS","HEROMOTOCO.NS","BANKBARODA.NS","OIL.NS","CAMS.NS","SUPREMEIND.NS",
    "CENTRALBK.NS","SONATSOFTW.NS","EICHERMOT.NS","DEVYANI.NS","AFCONS.NS","INDIAMART.NS",
    "UCOBANK.NS","SAREGAMA.NS","ENRIN.NS","MRPL.NS","ABLBL.NS","BAJAJ-AUTO.NS","ATHERENERG.NS",
    "SAILIFE.NS","MAZDOCK.NS","CERA.NS","KSB.NS","ACC.NS","POWERGRID.NS","AUBANK.NS","PRAJIND.NS",
    "NEULANDLAB.NS","NAVA.NS","AGARWALEYE.NS","INOXINDIA.NS","PVRINOX.NS","ALKYLAMINE.NS",
    "EXIDEIND.NS","ASIANPAINT.NS","ENGINERSIN.NS","ITC.NS","JYOTICNC.NS","ESCORTS.NS",
    "SCHAEFFLER.NS","AARTIIND.NS","HAL.NS","RKFORGE.NS","TORNTPHARM.NS","KPIL.NS","MRF.NS",
    "APLLTD.NS","METROPOLIS.NS","HFCL.NS","IRCON.NS","INTELLECT.NS","FLUOROCHEM.NS","BOSCHLTD.NS",
    "SUNDRMFAST.NS","RAILTEL.NS","INDGN.NS","SUNPHARMA.NS","MAXHEALTH.NS","MAHABANK.NS",
    "ABBOTINDIA.NS","AIIL.NS","CAMPUS.NS","BAJAJHLDNG.NS","IPCALAB.NS","APTUS.NS","NH.NS",
    "ZFCVINDIA.NS","GLAXO.NS","IGIL.NS","PETRONET.NS","BBTC.NS","LAURUSLABS.NS","JUBLPHARMA.NS",
    "SWANCORP.NS","JBCHEPHARM.NS","BHARTIHEXA.NS","AKUMS.NS","GLAND.NS","CEATLTD.NS","RBLBANK.NS",
    "APOLLOTYRE.NS","HOMEFIRST.NS","ERIS.NS","POLICYBZR.NS","SOLARINDS.NS","NATCOPHARM.NS",
    "IRB.NS","DABUR.NS","VIJAYA.NS","BALRAMCHIN.NS","GRSE.NS","SIEMENS.NS","INDIACEM.NS",
    "GILLETTE.NS","PIIND.NS","HINDUNILVR.NS","KFINTECH.NS","DCMSHRIRAM.NS","SKFINDUS.NS",
    "ONESOURCE.NS","JUBLFOOD.NS","TTML.NS"
]


BENCHMARKS = {
    "NIFTY_50": "^NSEI",
    "NIFTY_500": "^CRSLDX", 
    "BANK_NIFTY": "^NSEBANK",
}


# def add_asset_to_benchmark(
#     benchmark_name: str,
#     asset_id: int,
#     start_date,
#     end_date=None,
# ):
#     con = get_connection()
#     con.execute("BEGIN TRANSACTION")

#     try:
#         exists = con.execute(
#             "SELECT 1 FROM benchmarks WHERE name = ?",
#             [benchmark_name],
#         ).fetchone()

#         if not exists:
#             raise ValueError(f"Benchmark not found: {benchmark_name}")

#         con.execute(
#             """
#             INSERT INTO benchmark_membership
#             (benchmark_name, asset_id, start_date, end_date)
#             VALUES (?, ?, ?, ?)
#             """,
#             [benchmark_name, asset_id, start_date, end_date]
#         )

#         con.execute("COMMIT")
#         log.info(
#             "asset_added_to_benchmark",
#             benchmark=benchmark_name,
#             asset_id=asset_id,
#         )
#     except Exception as e:
#         con.execute("ROLLBACK")
#         log.error("benchmark_membership_failed", error=str(e))
#         raise
#     finally:
#         con.close()
